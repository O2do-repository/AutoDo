import{V as y,h}from"./forwardRefs-CdGulKb_.js";import{V as b,a as z,b as D,c as I}from"./VCard-BvF6_YjP.js";import{V as j}from"./VSpacer-Beoqu8Ad.js";import{V as T,a as N}from"./VSnackbar-BBDsuoD8.js";import{h as $,j as i,o as f,s as E,f as e,w as s,n as p,t as C,a5 as P,k as S,_ as B,i as V,l as w,F as A,z as L,ad as F,a6 as M,a7 as R,x as q,q as U,V as G}from"./index-Vi09p2H3.js";import{V as _,a as g}from"./VRow-DJiHg6uV.js";const J=$({__name:"DeleteConsultant",props:{consultantUuid:{}},emits:["consultantDeleted"],setup(a,{emit:o}){const u=a,x=o,r=i(!1),m=i(!1),c=i(!1),l=i(""),v=i(""),k=async()=>{console.log("Consultant UUID à supprimer:",u.consultantUuid),m.value=!0;try{if(!(await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/consultant/${u.consultantUuid}`,{method:"DELETE"})).ok)throw new Error("Erreur lors de la suppression");x("consultantDeleted",u.consultantUuid),l.value="Consultant supprimé avec succès",v.value="green",r.value=!1}catch(n){l.value=n.message||"Erreur inconnue",v.value="red"}finally{c.value=!0,m.value=!1}};return(n,t)=>(f(),E("div",null,[e(y,{color:"error",variant:"text",icon:"mdi-delete",density:"comfortable",onClick:t[0]||(t[0]=d=>r.value=!0)}),e(T,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=d=>r.value=d),"max-width":"500"},{default:s(()=>[e(b,null,{default:s(()=>[e(z,{class:"headline"},{default:s(()=>t[4]||(t[4]=[p("Confirmer la suppression")])),_:1}),e(D,null,{default:s(()=>t[5]||(t[5]=[p(" Êtes-vous sûr de vouloir supprimer ce consultant ? ")])),_:1}),e(I,null,{default:s(()=>[e(j),e(y,{color:"grey",onClick:t[1]||(t[1]=d=>r.value=!1)},{default:s(()=>t[6]||(t[6]=[p("Annuler")])),_:1}),e(y,{color:"red",loading:m.value,onClick:k},{default:s(()=>t[7]||(t[7]=[p("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=d=>c.value=d),color:v.value,timeout:"3000"},{default:s(()=>[p(C(l.value),1)]),_:1},8,["modelValue","color"])]))}}),O=$({name:"ConsultantGrid",setup(){const a=i([]),o=i(!1),u=i(null),x=P(),r="https://via.placeholder.com/150?text=No+Image",m=async()=>{o.value=!0;try{const n=await fetch("https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/consultant");if(!n.ok)throw new Error("Failed to fetch consultants");const t=await n.json();a.value=t}catch(n){u.value=n.message||"Unknown error"}finally{o.value=!1}},c=n=>{a.value=a.value.filter(t=>t.consultantUuid!==n)},l=async n=>{try{if(!(await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/consultant/${n}`,{method:"DELETE"})).ok)throw new Error("Erreur lors de la suppression");a.value=a.value.filter(d=>d.consultantUuid!==n)}catch(t){console.error(t.message)}},v=n=>{sessionStorage.setItem("selectedConsultant",JSON.stringify(n)),x.push("/consultant/consultant-info")},k=n=>{n.target.src=r};return S(()=>{m()}),{consultants:a,loading:o,error:u,deleteConsultant:l,goToConsultantProfiles:v,defaultImage:r,setPlaceholder:k,handleConsultantDeleted:c}}}),H={class:"text-caption grey--text"};function K(a,o,u,x,r,m){const c=J;return f(),V(G,null,{default:s(()=>[e(_,{justify:"center"},{default:s(()=>[e(g,{cols:"12",class:"text-center mb-6"},{default:s(()=>o[2]||(o[2]=[w("h2",{class:"purple--text"},"A perfect blend of genius and caffeine",-1)])),_:1}),(f(!0),E(A,null,L(a.consultants,l=>(f(),V(g,{key:l.consultantUuid,cols:"12",sm:"4",md:"2",class:"text-center"},{default:s(()=>[e(b,{class:"consultant-card",elevation:"3",onClick:v=>a.goToConsultantProfiles(l)},{default:s(()=>[e(c,{consultantUuid:l.consultantUuid,onClick:o[0]||(o[0]=F(()=>{},["stop"])),onConsultantDeleted:a.handleConsultantDeleted},null,8,["consultantUuid","onConsultantDeleted"]),e(D,{class:"d-flex flex-column align-center justify-center"},{default:s(()=>[e(M,{size:"150"},{default:s(()=>[e(R,{src:l.picture?l.picture:a.defaultImage,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:2},1024),w("div",null,C(l.name)+" "+C(l.surname),1),w("div",H,C(l.email),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128)),e(g,{cols:"12",sm:"4",md:"2",class:"text-center"},{default:s(()=>[e(b,{outlined:"",class:"consultant-card d-flex flex-column align-center justify-center"},{default:s(()=>[e(y,{onClick:o[1]||(o[1]=l=>a.$router.push("/consultant/add-consultant")),icon:"",color:"primary"},{default:s(()=>[e(q,{large:""},{default:s(()=>o[3]||(o[3]=[p("mdi-plus-circle")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a.loading?(f(),V(_,{key:0,justify:"center"},{default:s(()=>[e(g,{cols:"12",class:"text-center"},{default:s(()=>[e(h,{indeterminate:"",color:"primary"})]),_:1})]),_:1})):U("",!0),a.error?(f(),V(_,{key:1,justify:"center"},{default:s(()=>[e(g,{cols:"12",class:"text-center red--text"},{default:s(()=>[p(C(a.error),1)]),_:1})]),_:1})):U("",!0)]),_:1})}const Q=B(O,[["render",K],["__scopeId","data-v-ad9e6b51"]]),se=$({__name:"list-consultant",setup(a){return(o,u)=>(f(),V(Q))}});export{se as default};
