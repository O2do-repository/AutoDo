import{d as I,ab as E,r as i,o as P,a as m,c as D,w as t,f as T,g as e,k as h,e as s,j as V,ac as F,ad as R,b as k,t as d,h as x,_ as $,V as q,F as j}from"./index-D8MERzqI.js";import{V as z,a as O,b as B,c as J}from"./VCard-CGEy0ylf.js";import{a as H,V as g}from"./VRow-3M6D_VNM.js";import{f as M}from"./fetchWithApiKey-BHeBVSLA.js";import{V as K}from"./VSpacer-DX7eq24M.js";import{V as W,a as L}from"./VSnackbar-Dd5gUd_h.js";import{V as N}from"./VAlert-DSxEWnXa.js";import{V as G}from"./VTextField-CQ46poHY.js";import{V as Q}from"./VDataTable-DTkOM7ok.js";import"./filter-DiY0Wcrd.js";import"./VChip-BqUg7Ra9.js";const X={key:1},Y=I({__name:"ConsultantInfo",setup(U){const y=E(),o=i(null),c=()=>{o.value&&(sessionStorage.setItem("editConsultant",JSON.stringify(o.value)),y.push("/consultant/edit-consultant"))};return P(()=>{const f=sessionStorage.getItem("selectedConsultant");f&&(o.value=JSON.parse(f))}),(f,l)=>o.value?(m(),D(z,{key:0,class:"pa-4 mb-4"},{default:t(()=>[e(V,{to:"/consultant/list-consultant",class:"back-btn",outlined:"",color:"primary",size:"small",icon:""},{default:t(()=>[e(h,null,{default:t(()=>l[0]||(l[0]=[s("mdi-arrow-left")])),_:1})]),_:1}),e(O,null,{default:t(()=>l[1]||(l[1]=[s(" Informations du Consultant ")])),_:1}),e(B,null,{default:t(()=>[e(H,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(F,{size:"150"},{default:t(()=>[e(R,{src:o.value.picture,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:1})]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[2]||(l[2]=k("strong",null,"nom et prénom :",-1)),s(" "+d(o.value.name)+" "+d(o.value.surname),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[3]||(l[3]=k("strong",null,"Email :",-1)),s(" "+d(o.value.email),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[4]||(l[4]=k("strong",null,"Téléphone :",-1)),s(" "+d(o.value.phone),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[5]||(l[5]=k("strong",null,"Entreprise :",-1)),s(" "+d(o.value.enterprise),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[6]||(l[6]=k("strong",null,"Interne :",-1)),s(" "+d(o.value.intern?"Oui":"Non"),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[7]||(l[7]=k("strong",null,"Date de disponibilité :",-1)),s(" "+d(o.value.availabilityDate),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[8]||(l[8]=k("strong",null,"Date d'expiration CI :",-1)),s(" "+d(o.value.expirationDateCI),1)]),_:1}),e(g,{cols:"12"},{default:t(()=>[l[10]||(l[10]=k("strong",null,"Copie de la carte d'identité : ",-1)),o.value.copyCI?(m(),D(V,{key:0,href:o.value.copyCI,"prepend-icon":"mdi-file",target:"_blank",variant:"outlined",color:"primary"},{default:t(()=>l[9]||(l[9]=[s(" Voir le document ")])),_:1},8,["href"])):(m(),x("span",X,"Non disponible"))]),_:1})]),_:1})]),_:1}),e(J,{class:"d-flex justify-end"},{default:t(()=>[e(V,{color:"primary",variant:"tonal",icon:"mdi-pencil",onClick:c})]),_:1})]),_:1})):T("",!0)}}),Z=$(Y,[["__scopeId","data-v-65b61639"]]),ee=I({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(U,{emit:y}){const o=U,c=y,f=i(!1),l=i(!1),b=i(!1),C=i(""),v=i("");E();const S=async()=>{if(!o.profileUuid){C.value="UUID profil manquant",v.value="red",b.value=!0;return}l.value=!0;try{const _=await M(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${o.profileUuid}`,{method:"DELETE"}),a=await _.text();let u;try{u=JSON.parse(a)}catch{throw new Error("Erreur serveur : réponse invalide")}if(!_.ok||!u.success)throw new Error(u.message);c("profileDeleted",{uuid:o.profileUuid,message:u.message})}catch(_){C.value=_.message,v.value="red"}finally{b.value=!0,l.value=!1}};return(_,a)=>(m(),x("div",null,[e(V,{color:"error",icon:"mdi-delete",density:"comfortable",onClick:a[0]||(a[0]=u=>f.value=!0)}),e(W,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=u=>f.value=u),"max-width":"500"},{default:t(()=>[e(z,null,{default:t(()=>[e(O,{class:"headline"},{default:t(()=>a[4]||(a[4]=[s("Confirmer la suppression")])),_:1}),e(B,null,{default:t(()=>a[5]||(a[5]=[s(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),e(J,null,{default:t(()=>[e(K),e(V,{color:"grey",onClick:a[1]||(a[1]=u=>f.value=!1)},{default:t(()=>a[6]||(a[6]=[s("Annuler")])),_:1}),e(V,{color:"red",loading:l.value,onClick:S},{default:t(()=>a[7]||(a[7]=[s("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=u=>b.value=u),color:v.value,timeout:"3000"},{default:t(()=>[s(d(C.value),1)]),_:1},8,["modelValue","color"])]))}}),te=["href"],le={key:1},oe=I({__name:"TableProfile",setup(U){const y=E(),o=i([]),c=i(null),f=i(""),l=i(!1),b=i(""),C=i("");i(null);const v=i(null);P(()=>{const r=sessionStorage.getItem("selectedConsultant");r?(v.value=JSON.parse(r),u()):c.value="Aucun consultant sélectionné."});const S=()=>{v.value?(sessionStorage.setItem("selectedConsultantUuid",v.value.consultantUuid),y.push("/profile/add-profile")):c.value="Aucun consultant sélectionné."},_=({uuid:r,message:p})=>{r?(o.value=o.value.filter(n=>n.profileUuid!==r),C.value="success"):C.value="error",b.value=p,l.value=!0,r&&u()},a=i([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),u=async()=>{if(!v.value){c.value="Aucun consultant trouvé.";return}try{const r=await M(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/consultant/${v.value.consultantUuid}`,{});if(!r.ok)throw new Error("Erreur lors de la récupération des profils");const{data:p}=await r.json();o.value=p}catch(r){c.value=r instanceof Error?r.message:"Une erreur est survenue"}},A=r=>{localStorage.setItem("selectedProfile",JSON.stringify(r)),y.push({path:"/profile/edit-profile"})};return(r,p)=>(m(),x(j,null,[e(q,null,{default:t(()=>[p[3]||(p[3]=k("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),e(V,{onClick:S,icon:"mdi-plus",color:"primary",class:"mb-4"}),c.value?(m(),D(N,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:t(()=>[s(d(c.value),1)]),_:1})):T("",!0),e(G,{modelValue:f.value,"onUpdate:modelValue":p[0]||(p[0]=n=>f.value=n),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),e(Q,{headers:a.value,items:o.value,search:f.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.cv":t(({item:n})=>[n.cv&&n.cv.trim()!==""?(m(),x("a",{key:0,href:n.cv,target:"_blank"},"Voir le CV",8,te)):(m(),x("span",le,"Non disponible"))]),"item.skills":t(({item:n})=>{var w;return[s(d((w=n.skills)!=null&&w.length?n.skills.join(", "):"Aucune compétence"),1)]}),"item.keywords":t(({item:n})=>{var w;return[s(d((w=n.keywords)!=null&&w.length?n.keywords.join(", "):"Aucun mot-clé"),1)]}),"item.actions":t(({item:n})=>[e(V,{color:"primary",onClick:w=>A(n),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":t(({item:n})=>[e(ee,{profileUuid:n.profileUuid,onProfileDeleted:_},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!o.value.length&&!c.value?(m(),D(N,{key:1,type:"info",class:"mt-4"},{default:t(()=>p[2]||(p[2]=[s(" Aucun profil disponible. ")])),_:1})):T("",!0)]),_:1}),e(L,{modelValue:l.value,"onUpdate:modelValue":p[1]||(p[1]=n=>l.value=n),color:C.value,timeout:"3000"},{default:t(()=>[s(d(b.value),1)]),_:1},8,["modelValue","color"])],64))}}),ae=$(oe,[["__scopeId","data-v-9c23cb47"]]),ge=I({__name:"consultant-info",setup(U){return(y,o)=>(m(),x(j,null,[e(Z),e(ae)],64))}});export{ge as default};
