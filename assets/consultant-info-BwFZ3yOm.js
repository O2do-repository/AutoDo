import{h as E,v as U,j as r,k as A,o as p,i as S,w as t,f as e,n as s,y as J,z as L,l as k,t as u,s as x,q as T,V as F,F as N,_ as R}from"./index-Cz8dIHak.js";import{G}from"./GoBackBtn-CtgXFm15.js";import{a as $,b as j,c as B,V as M}from"./VCard-DjH9YsHY.js";import{V as h,a as g}from"./VRow-C3KvOCcA.js";import{V as b}from"./forwardRefs-BjVr3qn7.js";import{V as q}from"./VSpacer-CZ3T4RJ-.js";import{V as H,a as z}from"./VSnackbar-BYmOlnSN.js";import{V as P}from"./VAlert-CpyW0e_K.js";import{V as K}from"./VSelect-DFfWMbxb.js";import{V as Q}from"./VDataTable-B2Fgctnu.js";const W={key:1},X=E({__name:"ConsultantInfo",setup(D){const C=U(),o=r(null),f=()=>{o.value&&(sessionStorage.setItem("editConsultant",JSON.stringify(o.value)),C.push("/consultant/edit-consultant"))};return A(()=>{const c=sessionStorage.getItem("selectedConsultant");c&&(o.value=JSON.parse(c))}),(c,l)=>o.value?(p(),S(M,{key:0,class:"pa-4 mb-4"},{default:t(()=>[e(G),e($,null,{default:t(()=>l[0]||(l[0]=[s(" Informations du Consultant ")])),_:1}),e(j,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(J,{size:"150"},{default:t(()=>[e(L,{src:o.value.picture,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:1})]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[1]||(l[1]=k("strong",null,"Nom :",-1)),s(" "+u(o.value.name)+" "+u(o.value.surname),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[2]||(l[2]=k("strong",null,"Email :",-1)),s(" "+u(o.value.email),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[3]||(l[3]=k("strong",null,"Téléphone :",-1)),s(" "+u(o.value.phone),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[4]||(l[4]=k("strong",null,"Entreprise :",-1)),s(" "+u(o.value.enterprise),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[5]||(l[5]=k("strong",null,"Interne :",-1)),s(" "+u(o.value.intern?"Oui":"Non"),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[6]||(l[6]=k("strong",null,"Date de disponibilité :",-1)),s(" "+u(o.value.availabilityDate),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[7]||(l[7]=k("strong",null,"Date d'expiration CI :",-1)),s(" "+u(o.value.expirationDateCI),1)]),_:1}),e(g,{cols:"12"},{default:t(()=>[l[9]||(l[9]=k("strong",null,"Copie de la carte d'identité : ",-1)),o.value.copyCI?(p(),S(b,{key:0,href:o.value.copyCI,"prepend-icon":"mdi-file",target:"_blank",variant:"outlined",color:"primary"},{default:t(()=>l[8]||(l[8]=[s(" Voir le document ")])),_:1},8,["href"])):(p(),x("span",W,"Non disponible"))]),_:1})]),_:1})]),_:1}),e(B,{class:"d-flex justify-end"},{default:t(()=>[e(b,{color:"primary",variant:"tonal",onClick:f},{default:t(()=>l[10]||(l[10]=[s(" Modifier ")])),_:1})]),_:1})]),_:1})):T("",!0)}}),Y=E({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(D,{emit:C}){const o=r(!1),f=r(""),c=r(""),l=D,w=C,V=r(!1),m=r(!1);U();const I=async()=>{m.value=!0;try{const v=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${l.profileUuid}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!v.ok)throw new Error(`Erreur ${v.status}: Suppression échouée`);V.value=!1,w("profileDeleted",{message:"Profil supprimé avec succès",color:"green"})}catch(v){console.error(v);const a=v instanceof Error?v.message:"Erreur inattendue";w("profileDeleted",{message:a,color:"red"})}finally{m.value=!1}};return(v,a)=>(p(),x("div",null,[e(b,{color:"red",icon:"mdi-delete",density:"comfortable",onClick:a[0]||(a[0]=y=>V.value=!0)}),e(H,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=y=>V.value=y),"max-width":"500"},{default:t(()=>[e(M,null,{default:t(()=>[e($,{class:"headline"},{default:t(()=>a[4]||(a[4]=[s("Confirmer la suppression")])),_:1}),e(j,null,{default:t(()=>a[5]||(a[5]=[s(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),e(B,null,{default:t(()=>[e(q),e(b,{color:"grey",onClick:a[1]||(a[1]=y=>V.value=!1)},{default:t(()=>a[6]||(a[6]=[s("Annuler")])),_:1}),e(b,{color:"red",loading:m.value,onClick:I},{default:t(()=>a[7]||(a[7]=[s("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(z,{modelValue:o.value,"onUpdate:modelValue":a[3]||(a[3]=y=>o.value=y),color:c.value,timeout:"3000"},{default:t(()=>[s(u(f.value),1)]),_:1},8,["modelValue","color"])]))}}),Z=["href"],ee={key:1},te=E({__name:"TableProfile",setup(D){const C=U(),o=r([]),f=r(null),c=r(""),l=r(!1),w=r(""),V=r("");r(null);const m=r(null);A(()=>{const i=sessionStorage.getItem("selectedConsultant");i?(m.value=JSON.parse(i),y()):f.value="Aucun consultant sélectionné."});const I=()=>{m.value?(sessionStorage.setItem("selectedConsultantUuid",m.value.consultantUuid),C.push("/profile/add-profile")):f.value="Aucun consultant sélectionné."},v=i=>{w.value=i.message,V.value=i.color,l.value=!0,y()},a=r([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),y=async()=>{if(!m.value){f.value="Aucun consultant trouvé.";return}try{const i=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/consultant/${m.value.consultantUuid}`);if(!i.ok)throw new Error("Erreur lors de la récupération des profils");const d=await i.json();o.value=d}catch(i){f.value=i instanceof Error?i.message:"Une erreur est survenue"}},O=i=>{localStorage.setItem("selectedProfile",JSON.stringify(i)),C.push({path:"/profile/edit-profile"})};return(i,d)=>(p(),x(N,null,[e(F,null,{default:t(()=>[d[4]||(d[4]=k("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),e(b,{onClick:I,color:"primary",class:"mb-4"},{default:t(()=>d[2]||(d[2]=[s("Ajouter un profil")])),_:1}),f.value?(p(),S(P,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:t(()=>[s(u(f.value),1)]),_:1})):T("",!0),e(K,{modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=n=>c.value=n),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),e(Q,{headers:a.value,items:o.value,search:c.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.cv":t(({item:n})=>[n.cv&&n.cv.trim()!==""?(p(),x("a",{key:0,href:n.cv,target:"_blank"},"Voir le CV",8,Z)):(p(),x("span",ee,"Non disponible"))]),"item.skills":t(({item:n})=>{var _;return[s(u((_=n.skills)!=null&&_.length?n.skills.join(", "):"Aucune compétence"),1)]}),"item.keywords":t(({item:n})=>{var _;return[s(u((_=n.keywords)!=null&&_.length?n.keywords.join(", "):"Aucun mot-clé"),1)]}),"item.actions":t(({item:n})=>[e(b,{color:"primary",onClick:_=>O(n),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":t(({item:n})=>[e(Y,{profileUuid:n.profileUuid,onProfileDeleted:v},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!o.value.length&&!f.value?(p(),S(P,{key:1,type:"info",class:"mt-4"},{default:t(()=>d[3]||(d[3]=[s(" Aucun profil disponible. ")])),_:1})):T("",!0)]),_:1}),e(z,{modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=n=>l.value=n),color:V.value,timeout:"3000"},{default:t(()=>[s(u(w.value),1)]),_:1},8,["modelValue","color"])],64))}}),le=R(te,[["__scopeId","data-v-aaee0f0d"]]),ce=E({__name:"consultant-info",setup(D){return(C,o)=>(p(),x(N,null,[e(X),e(le)],64))}});export{ce as default};
