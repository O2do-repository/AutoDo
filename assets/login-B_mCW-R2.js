import{d as k,a1 as x,r as c,o as b,a as i,c as p,w as n,g as o,e as m,j as _,b as w,h as V,t as v,f as C,V as B,_ as y}from"./index-hk0c25y8.js";import{V as $,a as z,b as j}from"./VCard-L2V8p4Pb.js";import{V as I}from"./VBtn-DWpapVDc.js";const S={key:0,class:"text-error mb-4"},T=k({__name:"LoginBtn",setup(g){const t="https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net",r=x(),l=c(null),u=c(!0),d=c(null);function h(){window.location.href=`${t}/.auth/login/github?post_login_redirect_uri=${encodeURIComponent(`${t}/user/token`)}`}return b(async()=>{try{const a=localStorage.getItem("autodo_token");if(a){const e=await fetch(`${t}/user/me`,{headers:{Authorization:`Bearer ${a}`}});if(e.ok){l.value=await e.json(),r.push("/consultant/list-consultant");return}else localStorage.removeItem("autodo_token")}try{const e=await fetch(`${t}/user/token`,{credentials:"include"});if(e.ok){const s=await e.json();if(s.token){localStorage.setItem("autodo_token",s.token);const f=await fetch(`${t}/user/me`,{headers:{Authorization:`Bearer ${s.token}`}});f.ok&&(l.value=await f.json(),r.push("/consultant/list-consultant"))}}}catch(e){console.error("Erreur d'authentification:",e)}}catch(a){console.error("Erreur:",a)}finally{u.value=!1}}),(a,e)=>(i(),p(B,{class:"fill-height d-flex align-center justify-center"},{default:n(()=>[o($,{class:"pa-8",elevation:"12",rounded:"2xl","max-width":"400"},{default:n(()=>[o(z,{class:"text-h5 text-center mb-4"},{default:n(()=>e[0]||(e[0]=[m(" Connexion ")])),_:1}),o(j,{class:"text-center"},{default:n(()=>[o(_,{icon:"mdi-github",size:"56",color:"primary",class:"mb-4"}),e[2]||(e[2]=w("p",{class:"mb-6"}," Connecte-toi avec ton compte GitHub (membre O2do requis). ",-1)),d.value?(i(),V("div",S,v(d.value),1)):C("",!0),o(I,{color:"primary",size:"large",rounded:"",onClick:h,loading:u.value},{default:n(()=>[o(_,{start:"",icon:"mdi-login"}),e[1]||(e[1]=m(" Se connecter "))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}))}}),N={};function R(g,t){const r=T;return i(),p(r)}const U=y(N,[["render",R]]);export{U as default};
