import{p as F,g as z,A as O,X as H,j as f,J as le,Y as re,H as D,O as Y,e as W,E,f as i,Z as q,$ as se,a0 as ie,a1 as ue,a2 as ce,z as de,a3 as fe,a4 as me,a5 as ve,F as B,a6 as pe,a7 as ge,a8 as ke,k as G,a9 as ye,C as Ve,aa as be,ab as he,c as we,G as Pe,h as N,v as J,o as w,s as _,w as c,n as V,t as C,l as Ce,i as $,q as I,V as Ee,K as xe,_ as Te}from"./index-DiOBpi5B.js";import{n as K,o as Se,p as A,j as X,q as _e,r as De,s as Ae,t as Le,b as x,V as Ue}from"./VSelect-CwedKsHT.js";import{V as Be,a as $e,b as Ne,c as Re}from"./VCard-DSkbOCU7.js";import{V as je}from"./VSpacer-CP9Usddf.js";import{V as M}from"./VAlert-NxIpM7sK.js";import{V as Ie}from"./VDataTable-CWHp-8ID.js";const Me=F({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...K({origin:"center center",scrollStrategy:"block",transition:{component:Se},zIndex:2400})},"VDialog"),Fe=z()({name:"VDialog",props:Me(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,m){let{emit:s,slots:l}=m;const v=O(e,"modelValue"),{scopeId:y}=H(),u=f();function d(r){var n,a;const t=r.relatedTarget,o=r.target;if(t!==o&&((n=u.value)!=null&&n.contentEl)&&((a=u.value)!=null&&a.globalTop)&&![document,u.value.contentEl].includes(o)&&!u.value.contentEl.contains(o)){const g=se(u.value.contentEl);if(!g.length)return;const h=g[0],L=g[g.length-1];t===h?L.focus():h.focus()}}le(()=>{document.removeEventListener("focusin",d)}),re&&D(()=>v.value&&e.retainFocus,r=>{r?document.addEventListener("focusin",d):document.removeEventListener("focusin",d)},{immediate:!0});function k(){var r;s("afterEnter"),(r=u.value)!=null&&r.contentEl&&!u.value.contentEl.contains(document.activeElement)&&u.value.contentEl.focus({preventScroll:!0})}function b(){s("afterLeave")}return D(v,async r=>{var t;r||(await Y(),(t=u.value.activatorEl)==null||t.focus({preventScroll:!0}))}),W(()=>{const r=A.filterProps(e),t=E({"aria-haspopup":"dialog"},e.activatorProps),o=E({tabindex:-1},e.contentProps);return i(A,E({ref:u,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},r,{modelValue:v.value,"onUpdate:modelValue":n=>v.value=n,"aria-modal":"true",activatorProps:t,contentProps:o,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:k,onAfterLeave:b},y),{activator:l.activator,default:function(){for(var n=arguments.length,a=new Array(n),g=0;g<n;g++)a[g]=arguments[g];return i(q,{root:"VDialog"},{default:()=>{var h;return[(h=l.default)==null?void 0:h.call(l,...a)]}})}})}),X({},u)}});function ze(e){const m=B(e());let s=-1;function l(){clearInterval(s)}function v(){l(),Y(()=>m.value=e())}function y(u){const d=u?getComputedStyle(u):{transitionDuration:.2},k=parseFloat(d.transitionDuration)*1e3||200;if(l(),m.value<=0)return;const b=performance.now();s=window.setInterval(()=>{const r=performance.now()-b+k;m.value=Math.max(e()-r,0),m.value<=0&&l()},k)}return he(l),{clear:l,time:m,start:y,reset:v}}const Oe=F({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,..._e({location:"bottom"}),...De(),...ie(),...ue(),...ce(),...de(K({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Z=z()({name:"VSnackbar",props:Oe(),emits:{"update:modelValue":e=>!0},setup(e,m){let{slots:s}=m;const l=O(e,"modelValue"),{positionClasses:v}=Ae(e),{scopeId:y}=H(),{themeClasses:u}=fe(e),{colorClasses:d,colorStyles:k,variantClasses:b}=me(e),{roundedClasses:r}=ve(e),t=ze(()=>Number(e.timeout)),o=f(),n=f(),a=B(!1),g=B(0),h=f(),L=pe(ge,void 0);ke(()=>!!L,()=>{const p=we();Pe(()=>{h.value=p.mainStyles.value})}),D(l,T),D(()=>e.timeout,T),G(()=>{l.value&&T()});let U=-1;function T(){t.reset(),window.clearTimeout(U);const p=Number(e.timeout);if(!l.value||p===-1)return;const P=ye(n.value);t.start(P),U=window.setTimeout(()=>{l.value=!1},p)}function Q(){t.reset(),window.clearTimeout(U)}function ee(){a.value=!0,Q()}function R(){a.value=!1,T()}function te(p){g.value=p.touches[0].clientY}function ae(p){Math.abs(g.value-p.changedTouches[0].clientY)>50&&(l.value=!1)}function oe(){a.value&&R()}const ne=Ve(()=>e.location.split(" ").reduce((p,P)=>(p[`v-snackbar--${P}`]=!0,p),{}));return W(()=>{const p=A.filterProps(e),P=!!(s.default||s.text||e.text);return i(A,E({ref:o,class:["v-snackbar",{"v-snackbar--active":l.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},ne.value,v.value,e.class],style:[h.value,e.style]},p,{modelValue:l.value,"onUpdate:modelValue":S=>l.value=S,contentProps:E({class:["v-snackbar__wrapper",u.value,d.value,r.value,b.value],style:[k.value],onPointerenter:ee,onPointerleave:R},p.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:te,onTouchend:ae,onAfterLeave:oe},y),{default:()=>{var S,j;return[be(!1,"v-snackbar"),e.timer&&!a.value&&i("div",{key:"timer",class:"v-snackbar__timer"},[i(Le,{ref:n,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":t.time.value},null)]),P&&i("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((S=s.text)==null?void 0:S.call(s))??e.text,(j=s.default)==null?void 0:j.call(s)]),s.actions&&i(q,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[i("div",{class:"v-snackbar__actions"},[s.actions({isActive:l})])]})]},activator:s.activator})}),X({},o)}}),He=N({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(e,{emit:m}){const s=f(!1),l=f(""),v=f(""),y=e,u=m,d=f(!1),k=f(!1);J();const b=async()=>{k.value=!0;try{const r=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${y.profileUuid}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Erreur ${r.status}: Suppression échouée`);d.value=!1,u("profileDeleted",{message:"Profil supprimé avec succès",color:"green"})}catch(r){console.error(r);const t=r instanceof Error?r.message:"Erreur inattendue";u("profileDeleted",{message:t,color:"red"})}finally{k.value=!1}};return(r,t)=>(w(),_("div",null,[i(x,{color:"red",icon:"mdi-delete",density:"comfortable",onClick:t[0]||(t[0]=o=>d.value=!0)}),i(Fe,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=o=>d.value=o),"max-width":"500"},{default:c(()=>[i(Be,null,{default:c(()=>[i($e,{class:"headline"},{default:c(()=>t[4]||(t[4]=[V("Confirmer la suppression")])),_:1}),i(Ne,null,{default:c(()=>t[5]||(t[5]=[V(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),i(Re,null,{default:c(()=>[i(je),i(x,{color:"grey",onClick:t[1]||(t[1]=o=>d.value=!1)},{default:c(()=>t[6]||(t[6]=[V("Annuler")])),_:1}),i(x,{color:"red",loading:k.value,onClick:b},{default:c(()=>t[7]||(t[7]=[V("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(Z,{modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value=o),color:v.value,timeout:"3000"},{default:c(()=>[V(C(l.value),1)]),_:1},8,["modelValue","color"])]))}}),Ye=["href"],We={key:1},qe=N({__name:"TableProfile",setup(e){const m=J(),s=f([]),l=f(null),v=f(""),y=f(!1),u=f(""),d=f(""),k=o=>{u.value=o.message,d.value=o.color,y.value=!0,r()},b=f([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),r=async()=>{try{const o=await fetch("https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil");if(!o.ok)throw new Error("Erreur lors de la récupération des profils");const n=await o.json();console.log("Données reçues :",n),s.value=Array.isArray(n)?n:[n]}catch(o){l.value=o instanceof Error?o.message:"Une erreur est survenue"}},t=o=>{localStorage.setItem("selectedProfile",JSON.stringify(o)),m.push({path:`/edit-profile/${o.profileUuid}`})};return G(r),(o,n)=>(w(),_(xe,null,[i(Ee,null,{default:c(()=>[n[5]||(n[5]=Ce("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),i(x,{onClick:n[0]||(n[0]=a=>o.$router.push("/add-profile")),color:"primary",class:"mb-4"},{default:c(()=>n[3]||(n[3]=[V("Ajouter un profil")])),_:1}),l.value?(w(),$(M,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:c(()=>[V(C(l.value),1)]),_:1})):I("",!0),i(Ue,{modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=a=>v.value=a),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),i(Ie,{headers:b.value,items:s.value,search:v.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.CV":c(({item:a})=>[a.CV?(w(),_("a",{key:0,href:a.CV,target:"_blank"},"Voir le CV",8,Ye)):(w(),_("span",We,"Non disponible"))]),"item.skills":c(({item:a})=>[V(C(a.skills&&a.skills.length?a.skills.join(", "):"Aucune compétence"),1)]),"item.keywords":c(({item:a})=>[V(C(a.keywords&&a.keywords.length?a.keywords.join(", "):"Aucun mot-clé"),1)]),"item.actions":c(({item:a})=>[i(x,{color:"primary",onClick:g=>t(a),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":c(({item:a})=>[i(He,{profileUuid:a.profileUuid,onProfileDeleted:k},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!s.value.length&&!l.value?(w(),$(M,{key:1,type:"info",class:"mt-4"},{default:c(()=>n[4]||(n[4]=[V(" Aucun profil disponible. ")])),_:1})):I("",!0)]),_:1}),i(Z,{modelValue:y.value,"onUpdate:modelValue":n[2]||(n[2]=a=>y.value=a),color:d.value,timeout:"3000"},{default:c(()=>[V(C(u.value),1)]),_:1},8,["modelValue","color"])],64))}}),Ge=Te(qe,[["__scopeId","data-v-24a9246b"]]),tt=N({__name:"table-profile",setup(e){return(m,s)=>(w(),$(Ge))}});export{tt as default};
