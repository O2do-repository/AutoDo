import{G as me}from"./GoBackBtn-MgY6OdZg.js";import{a as H,b as G,V as J,c as ve}from"./VCard-8f-GiFw9.js";import{V as pe,a as S}from"./VRow-DjRD9HHV.js";import{h as N,j as m,k as O,o as w,i as L,w as l,f as a,n as f,H as ge,J as ke,l as h,t as b,s as E,q as R,p as W,g as Y,x as q,M as K,N as ye,I as be,G as U,e as Q,B as D,C as X,O as Ve,P as Z,Q as Ce,R as Pe,S as we,T as xe,U as Se,W as he,X as Ee,Y as M,Z as _e,$ as Te,a0 as De,y as Ae,a1 as Ie,a2 as Le,a3 as Ue,c as Be,a4 as Ne,v as ee,V as te,F as ae,_ as le}from"./index-BJ03CsVp.js";import{V as _,m as $e,b as Re,c as Me,d as Oe}from"./VBtn-1MYAy1QJ.js";import{V as je}from"./VSpacer-CoJTJd3Y.js";import{e as ne,f as Fe,g as B,h as oe,V as ze}from"./VSelect-CbB5Qgi_.js";import{V as z}from"./VAlert-CaiGLD5M.js";import{V as He}from"./VDataTable-CD4XsHEw.js";const Ge={key:1},Je=N({__name:"ConsultantInfo",setup(e){const o=m(null);return O(()=>{const s=sessionStorage.getItem("selectedConsultant");s&&(o.value=JSON.parse(s))}),(s,t)=>o.value?(w(),L(J,{key:0,class:"pa-4 mb-4"},{default:l(()=>[a(H,null,{default:l(()=>t[0]||(t[0]=[f("Informations du Consultant")])),_:1}),a(G,null,{default:l(()=>[a(pe,null,{default:l(()=>[a(S,{cols:"12"},{default:l(()=>[a(ge,{size:"150"},{default:l(()=>[a(ke,{src:o.value.picture,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:1})]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[1]||(t[1]=h("strong",null,"Nom :",-1)),f(" "+b(o.value.name)+" "+b(o.value.surname),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[2]||(t[2]=h("strong",null,"Email :",-1)),f(" "+b(o.value.email),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[3]||(t[3]=h("strong",null,"Téléphone :",-1)),f(" "+b(o.value.phone),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[4]||(t[4]=h("strong",null,"Entreprise :",-1)),f(" "+b(o.value.enterprise),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[5]||(t[5]=h("strong",null,"Interne :",-1)),f(" "+b(o.value.intern?"Oui":"Non"),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[6]||(t[6]=h("strong",null,"Date de disponibilité :",-1)),f(" "+b(o.value.availabilityDate),1)]),_:1}),a(S,{cols:"12",sm:"6"},{default:l(()=>[t[7]||(t[7]=h("strong",null,"Date d'expiration CI :",-1)),f(" "+b(o.value.expirationDateCI),1)]),_:1}),a(S,{cols:"12"},{default:l(()=>[t[9]||(t[9]=h("strong",null,"Copie de la carte d'identité : ",-1)),o.value.copyCI?(w(),L(_,{key:0,href:o.value.copyCI,"prepend-icon":"mdi-file",target:"_blank",variant:"outlined",color:"primary"},{default:l(()=>t[8]||(t[8]=[f(" Voir le document ")])),_:1},8,["href"])):(w(),E("span",Ge,"Non disponible"))]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0)}}),We=W({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...ne({origin:"center center",scrollStrategy:"block",transition:{component:Fe},zIndex:2400})},"VDialog"),Ye=Y()({name:"VDialog",props:We(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,o){let{emit:s,slots:t}=o;const k=q(e,"modelValue"),{scopeId:C}=K(),d=m();function p(u){var V,r;const n=u.relatedTarget,v=u.target;if(n!==v&&((V=d.value)!=null&&V.contentEl)&&((r=d.value)!=null&&r.globalTop)&&![document,d.value.contentEl].includes(v)&&!d.value.contentEl.contains(v)){const c=Ve(d.value.contentEl);if(!c.length)return;const i=c[0],P=c[c.length-1];n===i?P.focus():i.focus()}}ye(()=>{document.removeEventListener("focusin",p)}),be&&U(()=>k.value&&e.retainFocus,u=>{u?document.addEventListener("focusin",p):document.removeEventListener("focusin",p)},{immediate:!0});function g(){var u;s("afterEnter"),(u=d.value)!=null&&u.contentEl&&!d.value.contentEl.contains(document.activeElement)&&d.value.contentEl.focus({preventScroll:!0})}function x(){s("afterLeave")}return U(k,async u=>{var n;u||(await Z(),(n=d.value.activatorEl)==null||n.focus({preventScroll:!0}))}),Q(()=>{const u=B.filterProps(e),n=D({"aria-haspopup":"dialog"},e.activatorProps),v=D({tabindex:-1},e.contentProps);return a(B,D({ref:d,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},u,{modelValue:k.value,"onUpdate:modelValue":V=>k.value=V,"aria-modal":"true",activatorProps:n,contentProps:v,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:g,onAfterLeave:x},C),{activator:t.activator,default:function(){for(var V=arguments.length,r=new Array(V),c=0;c<V;c++)r[c]=arguments[c];return a(X,{root:"VDialog"},{default:()=>{var i;return[(i=t.default)==null?void 0:i.call(t,...r)]}})}})}),oe({},d)}});function qe(e){const o=M(e());let s=-1;function t(){clearInterval(s)}function k(){t(),Z(()=>o.value=e())}function C(d){const p=d?getComputedStyle(d):{transitionDuration:.2},g=parseFloat(p.transitionDuration)*1e3||200;if(t(),o.value<=0)return;const x=performance.now();s=window.setInterval(()=>{const u=performance.now()-x+g;o.value=Math.max(e()-u,0),o.value<=0&&t()},g)}return Le(t),{clear:t,time:o,start:C,reset:k}}const Ke=W({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...$e({location:"bottom"}),...Re(),...Ce(),...Pe(),...we(),...xe(ne({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),se=Y()({name:"VSnackbar",props:Ke(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:s}=o;const t=q(e,"modelValue"),{positionClasses:k}=Me(e),{scopeId:C}=K(),{themeClasses:d}=Se(e),{colorClasses:p,colorStyles:g,variantClasses:x}=he(e),{roundedClasses:u}=Ee(e),n=qe(()=>Number(e.timeout)),v=m(),V=m(),r=M(!1),c=M(0),i=m(),P=_e(Ue,void 0);Te(()=>!!P,()=>{const y=Be();Ne(()=>{i.value=y.mainStyles.value})}),U(t,A),U(()=>e.timeout,A),O(()=>{t.value&&A()});let $=-1;function A(){n.reset(),window.clearTimeout($);const y=Number(e.timeout);if(!t.value||y===-1)return;const T=De(V.value);n.start(T),$=window.setTimeout(()=>{t.value=!1},y)}function re(){n.reset(),window.clearTimeout($)}function ie(){r.value=!0,re()}function j(){r.value=!1,A()}function ue(y){c.value=y.touches[0].clientY}function ce(y){Math.abs(c.value-y.changedTouches[0].clientY)>50&&(t.value=!1)}function de(){r.value&&j()}const fe=Ae(()=>e.location.split(" ").reduce((y,T)=>(y[`v-snackbar--${T}`]=!0,y),{}));return Q(()=>{const y=B.filterProps(e),T=!!(s.default||s.text||e.text);return a(B,D({ref:v,class:["v-snackbar",{"v-snackbar--active":t.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},fe.value,k.value,e.class],style:[i.value,e.style]},y,{modelValue:t.value,"onUpdate:modelValue":I=>t.value=I,contentProps:D({class:["v-snackbar__wrapper",d.value,p.value,u.value,x.value],style:[g.value],onPointerenter:ie,onPointerleave:j},y.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:ue,onTouchend:ce,onAfterLeave:de},C),{default:()=>{var I,F;return[Ie(!1,"v-snackbar"),e.timer&&!r.value&&a("div",{key:"timer",class:"v-snackbar__timer"},[a(Oe,{ref:V,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":n.time.value},null)]),T&&a("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((I=s.text)==null?void 0:I.call(s))??e.text,(F=s.default)==null?void 0:F.call(s)]),s.actions&&a(X,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[a("div",{class:"v-snackbar__actions"},[s.actions({isActive:t})])]})]},activator:s.activator})}),oe({},v)}}),Qe=N({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(e,{emit:o}){const s=m(!1),t=m(""),k=m(""),C=e,d=o,p=m(!1),g=m(!1);ee();const x=async()=>{g.value=!0;try{const u=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${C.profileUuid}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!u.ok)throw new Error(`Erreur ${u.status}: Suppression échouée`);p.value=!1,d("profileDeleted",{message:"Profil supprimé avec succès",color:"green"})}catch(u){console.error(u);const n=u instanceof Error?u.message:"Erreur inattendue";d("profileDeleted",{message:n,color:"red"})}finally{g.value=!1}};return(u,n)=>(w(),E("div",null,[a(_,{color:"red",icon:"mdi-delete",density:"comfortable",onClick:n[0]||(n[0]=v=>p.value=!0)}),a(Ye,{modelValue:p.value,"onUpdate:modelValue":n[2]||(n[2]=v=>p.value=v),"max-width":"500"},{default:l(()=>[a(J,null,{default:l(()=>[a(H,{class:"headline"},{default:l(()=>n[4]||(n[4]=[f("Confirmer la suppression")])),_:1}),a(G,null,{default:l(()=>n[5]||(n[5]=[f(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),a(ve,null,{default:l(()=>[a(je),a(_,{color:"grey",onClick:n[1]||(n[1]=v=>p.value=!1)},{default:l(()=>n[6]||(n[6]=[f("Annuler")])),_:1}),a(_,{color:"red",loading:g.value,onClick:x},{default:l(()=>n[7]||(n[7]=[f("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=v=>s.value=v),color:k.value,timeout:"3000"},{default:l(()=>[f(b(t.value),1)]),_:1},8,["modelValue","color"])]))}}),Xe=["href"],Ze={key:1},et=N({__name:"TableProfile",setup(e){const o=ee(),s=m([]),t=m(null),k=m(""),C=m(!1),d=m(""),p=m("");m(null);const g=m(null);O(()=>{const r=sessionStorage.getItem("selectedConsultant");r?(g.value=JSON.parse(r),v()):t.value="Aucun consultant sélectionné."});const x=()=>{g.value?(sessionStorage.setItem("selectedConsultantUuid",g.value.consultantUuid),o.push("/add-profile")):t.value="Aucun consultant sélectionné."},u=r=>{d.value=r.message,p.value=r.color,C.value=!0,v()},n=m([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),v=async()=>{if(!g.value){t.value="Aucun consultant trouvé.";return}try{const r=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/consultant/${g.value.consultantUuid}`);if(!r.ok)throw new Error("Erreur lors de la récupération des profils");const c=await r.json();s.value=c}catch(r){t.value=r instanceof Error?r.message:"Une erreur est survenue"}},V=r=>{localStorage.setItem("selectedProfile",JSON.stringify(r)),o.push({path:`/edit-profile/${r.profileUuid}`})};return(r,c)=>(w(),E(ae,null,[a(te,null,{default:l(()=>[c[4]||(c[4]=h("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),a(_,{onClick:x,color:"primary",class:"mb-4"},{default:l(()=>c[2]||(c[2]=[f("Ajouter un profil")])),_:1}),t.value?(w(),L(z,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:l(()=>[f(b(t.value),1)]),_:1})):R("",!0),a(ze,{modelValue:k.value,"onUpdate:modelValue":c[0]||(c[0]=i=>k.value=i),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),a(He,{headers:n.value,items:s.value,search:k.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.cv":l(({item:i})=>[i.cv&&i.cv.trim()!==""?(w(),E("a",{key:0,href:i.cv,target:"_blank"},"Voir le CV",8,Xe)):(w(),E("span",Ze,"Non disponible"))]),"item.skills":l(({item:i})=>{var P;return[f(b((P=i.skills)!=null&&P.length?i.skills.join(", "):"Aucune compétence"),1)]}),"item.keywords":l(({item:i})=>{var P;return[f(b((P=i.keywords)!=null&&P.length?i.keywords.join(", "):"Aucun mot-clé"),1)]}),"item.actions":l(({item:i})=>[a(_,{color:"primary",onClick:P=>V(i),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":l(({item:i})=>[a(Qe,{profileUuid:i.profileUuid,onProfileDeleted:u},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!s.value.length&&!t.value?(w(),L(z,{key:1,type:"info",class:"mt-4"},{default:l(()=>c[3]||(c[3]=[f(" Aucun profil disponible. ")])),_:1})):R("",!0)]),_:1}),a(se,{modelValue:C.value,"onUpdate:modelValue":c[1]||(c[1]=i=>C.value=i),color:p.value,timeout:"3000"},{default:l(()=>[f(b(d.value),1)]),_:1},8,["modelValue","color"])],64))}}),tt=le(et,[["__scopeId","data-v-55ae7f1d"]]),at=N({__name:"table-profile",setup(e){return(o,s)=>(w(),E(ae,null,[a(te,{class:"go-back-btn"},{default:l(()=>[a(me)]),_:1}),a(Je),a(tt)],64))}}),ft=le(at,[["__scopeId","data-v-2d98f6e7"]]);export{ft as default};
