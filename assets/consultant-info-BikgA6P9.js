import{d as I,ab as E,r as u,o as P,a as g,c as D,w as t,f as T,g as e,k as F,e as a,j as V,ac as R,ad as h,b as v,t as i,h as x,_ as $,V as q,F as j}from"./index-D-Inbi5U.js";import{V as z,a as O,b as B,c as J}from"./VCard-D2J_XjvE.js";import{a as H,V as m}from"./VRow-CxmJ-ldm.js";import{f as M}from"./fetchWithApiKey-puCv6LHg.js";import{V as K}from"./VSpacer-DMfKlYC9.js";import{V as W,a as L}from"./VSnackbar-D_Vt-T1z.js";import{V as A}from"./VAlert-BJkg2Izn.js";import{V as G}from"./VTextField-Xr4deW5K.js";import{V as Q}from"./VDataTable-BOCEZ4ei.js";import"./filter-D2Osl6aZ.js";import"./VChip-CevWF3Km.js";const X={key:1},Y=I({__name:"ConsultantInfo",setup(U){const y=E(),o=u(null),c=()=>{o.value&&(sessionStorage.setItem("editConsultant",JSON.stringify(o.value)),y.push("/consultant/edit-consultant"))};return P(()=>{const f=sessionStorage.getItem("selectedConsultant");f&&(o.value=JSON.parse(f))}),(f,l)=>o.value?(g(),D(z,{key:0,class:"pa-4 mb-4"},{default:t(()=>[e(V,{to:"/consultant/list-consultant",class:"back-btn",outlined:"",color:"primary",size:"small",icon:""},{default:t(()=>[e(F,null,{default:t(()=>l[0]||(l[0]=[a("mdi-arrow-left")])),_:1})]),_:1}),e(O,null,{default:t(()=>l[1]||(l[1]=[a(" Informations du Consultant ")])),_:1}),e(B,null,{default:t(()=>[e(H,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(R,{size:"150"},{default:t(()=>[e(h,{src:o.value.picture,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:1})]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[2]||(l[2]=v("strong",null,"nom et prénom :",-1)),a(" "+i(o.value.name)+" "+i(o.value.surname),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[3]||(l[3]=v("strong",null,"Email :",-1)),a(" "+i(o.value.email),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[4]||(l[4]=v("strong",null,"Téléphone :",-1)),a(" "+i(o.value.phone),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[5]||(l[5]=v("strong",null,"Entreprise :",-1)),a(" "+i(o.value.enterprise),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[6]||(l[6]=v("strong",null,"Interne :",-1)),a(" "+i(o.value.intern?"Oui":"Non"),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[7]||(l[7]=v("strong",null,"Date de disponibilité :",-1)),a(" "+i(o.value.availabilityDate),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[8]||(l[8]=v("strong",null,"Date d'expiration CI :",-1)),a(" "+i(o.value.expirationDateCI),1)]),_:1}),e(m,{cols:"12",sm:"6"},{default:t(()=>[l[9]||(l[9]=v("strong",null,"Note :",-1)),a(" "+i(o.value.comment),1)]),_:1}),e(m,{cols:"12"},{default:t(()=>[l[11]||(l[11]=v("strong",null,"Copie de la carte d'identité : ",-1)),o.value.copyCI?(g(),D(V,{key:0,href:o.value.copyCI,"prepend-icon":"mdi-file",target:"_blank",variant:"outlined",color:"primary"},{default:t(()=>l[10]||(l[10]=[a(" Voir le document ")])),_:1},8,["href"])):(g(),x("span",X,"Non disponible"))]),_:1})]),_:1})]),_:1}),e(J,{class:"d-flex justify-end"},{default:t(()=>[e(V,{color:"primary",variant:"tonal",icon:"mdi-pencil",onClick:c})]),_:1})]),_:1})):T("",!0)}}),Z=$(Y,[["__scopeId","data-v-e9cf492e"]]),ee=I({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(U,{emit:y}){const o=U,c=y,f=u(!1),l=u(!1),b=u(!1),C=u(""),k=u("");E();const S=async()=>{if(!o.profileUuid){C.value="UUID profil manquant",k.value="red",b.value=!0;return}l.value=!0;try{const _=await M(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${o.profileUuid}`,{method:"DELETE"}),s=await _.text();let d;try{d=JSON.parse(s)}catch{throw new Error("Erreur serveur : réponse invalide")}if(!_.ok||!d.success)throw new Error(d.message);c("profileDeleted",{uuid:o.profileUuid,message:d.message})}catch(_){C.value=_.message,k.value="red"}finally{b.value=!0,l.value=!1}};return(_,s)=>(g(),x("div",null,[e(V,{color:"error",icon:"mdi-delete",density:"comfortable",onClick:s[0]||(s[0]=d=>f.value=!0)}),e(W,{modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=d=>f.value=d),"max-width":"500"},{default:t(()=>[e(z,null,{default:t(()=>[e(O,{class:"headline"},{default:t(()=>s[4]||(s[4]=[a("Confirmer la suppression")])),_:1}),e(B,null,{default:t(()=>s[5]||(s[5]=[a(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),e(J,null,{default:t(()=>[e(K),e(V,{color:"grey",onClick:s[1]||(s[1]=d=>f.value=!1)},{default:t(()=>s[6]||(s[6]=[a("Annuler")])),_:1}),e(V,{color:"red",loading:l.value,onClick:S},{default:t(()=>s[7]||(s[7]=[a("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L,{modelValue:b.value,"onUpdate:modelValue":s[3]||(s[3]=d=>b.value=d),color:k.value,timeout:"3000"},{default:t(()=>[a(i(C.value),1)]),_:1},8,["modelValue","color"])]))}}),te=["href"],le={key:1},oe=I({__name:"TableProfile",setup(U){const y=E(),o=u([]),c=u(null),f=u(""),l=u(!1),b=u(""),C=u("");u(null);const k=u(null);P(()=>{const r=sessionStorage.getItem("selectedConsultant");r?(k.value=JSON.parse(r),d()):c.value="Aucun consultant sélectionné."});const S=()=>{k.value?(sessionStorage.setItem("selectedConsultantUuid",k.value.consultantUuid),y.push("/profile/add-profile")):c.value="Aucun consultant sélectionné."},_=({uuid:r,message:p})=>{r?(o.value=o.value.filter(n=>n.profileUuid!==r),C.value="success"):C.value="error",b.value=p,l.value=!0,r&&d()},s=u([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),d=async()=>{if(!k.value){c.value="Aucun consultant trouvé.";return}try{const r=await M(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/consultant/${k.value.consultantUuid}`,{});if(!r.ok)throw new Error("Erreur lors de la récupération des profils");const{data:p}=await r.json();o.value=p}catch(r){c.value=r instanceof Error?r.message:"Une erreur est survenue"}},N=r=>{localStorage.setItem("selectedProfile",JSON.stringify(r)),y.push({path:"/profile/edit-profile"})};return(r,p)=>(g(),x(j,null,[e(q,null,{default:t(()=>[p[3]||(p[3]=v("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),e(V,{onClick:S,icon:"mdi-plus",color:"primary",class:"mb-4"}),c.value?(g(),D(A,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:t(()=>[a(i(c.value),1)]),_:1})):T("",!0),e(G,{modelValue:f.value,"onUpdate:modelValue":p[0]||(p[0]=n=>f.value=n),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),e(Q,{headers:s.value,items:o.value,search:f.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.cv":t(({item:n})=>[n.cv&&n.cv.trim()!==""?(g(),x("a",{key:0,href:n.cv,target:"_blank"},"Voir le CV",8,te)):(g(),x("span",le,"Non disponible"))]),"item.skills":t(({item:n})=>{var w;return[a(i((w=n.skills)!=null&&w.length?n.skills.join(", "):"Aucune compétence"),1)]}),"item.keywords":t(({item:n})=>{var w;return[a(i((w=n.keywords)!=null&&w.length?n.keywords.join(", "):"Aucun mot-clé"),1)]}),"item.actions":t(({item:n})=>[e(V,{color:"primary",onClick:w=>N(n),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":t(({item:n})=>[e(ee,{profileUuid:n.profileUuid,onProfileDeleted:_},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!o.value.length&&!c.value?(g(),D(A,{key:1,type:"info",class:"mt-4"},{default:t(()=>p[2]||(p[2]=[a(" Aucun profil disponible. ")])),_:1})):T("",!0)]),_:1}),e(L,{modelValue:l.value,"onUpdate:modelValue":p[1]||(p[1]=n=>l.value=n),color:C.value,timeout:"3000"},{default:t(()=>[a(i(b.value),1)]),_:1},8,["modelValue","color"])],64))}}),ae=$(oe,[["__scopeId","data-v-9c23cb47"]]),ge=I({__name:"consultant-info",setup(U){return(y,o)=>(g(),x(j,null,[e(Z),e(ae)],64))}});export{ge as default};
