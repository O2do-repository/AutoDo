import{h as S,a5 as T,j as r,k as $,o as c,i as I,w as t,f as e,x as L,n as a,a6 as h,a7 as F,l as k,t as u,s as x,q as P,_ as A,V as R,F as N}from"./index-ZazXWxPw.js";import{V as C}from"./forwardRefs-CqbgG9TC.js";import{a as j,b as z,c as M,V as B}from"./VCard-Bw5uizOt.js";import{V as q,a as g}from"./VRow-DuwBonE-.js";import{V as H}from"./VSpacer-4kA4RA-k.js";import{V as G,a as O}from"./VSnackbar-ChhLqGnk.js";import{V as U}from"./VAlert-C3EZeMba.js";import{V as K}from"./VTextField-BPs-mG9n.js";import{V as Q}from"./VDataTable-vLaW4sl7.js";import"./VSelect-BU8Fbwjv.js";const W={key:1},X=S({__name:"ConsultantInfo",setup(D){const b=T(),o=r(null),d=()=>{o.value&&(sessionStorage.setItem("editConsultant",JSON.stringify(o.value)),b.push("/consultant/edit-consultant"))};return $(()=>{const p=sessionStorage.getItem("selectedConsultant");p&&(o.value=JSON.parse(p))}),(p,l)=>o.value?(c(),I(B,{key:0,class:"pa-4 mb-4"},{default:t(()=>[e(C,{to:"/consultant/list-consultant",class:"back-btn",outlined:"",color:"primary",size:"small",icon:""},{default:t(()=>[e(L,null,{default:t(()=>l[0]||(l[0]=[a("mdi-arrow-left")])),_:1})]),_:1}),e(j,null,{default:t(()=>l[1]||(l[1]=[a(" Informations du Consultant ")])),_:1}),e(z,null,{default:t(()=>[e(q,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(h,{size:"150"},{default:t(()=>[e(F,{src:o.value.picture,alt:"Photo Consultant",contain:""},null,8,["src"])]),_:1})]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[2]||(l[2]=k("strong",null,"Prénom et nom :",-1)),a(" "+u(o.value.surname)+" "+u(o.value.name),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[3]||(l[3]=k("strong",null,"Email :",-1)),a(" "+u(o.value.email),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[4]||(l[4]=k("strong",null,"Téléphone :",-1)),a(" "+u(o.value.phone),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[5]||(l[5]=k("strong",null,"Entreprise :",-1)),a(" "+u(o.value.enterprise),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[6]||(l[6]=k("strong",null,"Interne :",-1)),a(" "+u(o.value.intern?"Oui":"Non"),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[7]||(l[7]=k("strong",null,"Date de disponibilité :",-1)),a(" "+u(o.value.availabilityDate),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[l[8]||(l[8]=k("strong",null,"Date d'expiration CI :",-1)),a(" "+u(o.value.expirationDateCI),1)]),_:1}),e(g,{cols:"12"},{default:t(()=>[l[10]||(l[10]=k("strong",null,"Copie de la carte d'identité : ",-1)),o.value.copyCI?(c(),I(C,{key:0,href:o.value.copyCI,"prepend-icon":"mdi-file",target:"_blank",variant:"outlined",color:"primary"},{default:t(()=>l[9]||(l[9]=[a(" Voir le document ")])),_:1},8,["href"])):(c(),x("span",W,"Non disponible"))]),_:1})]),_:1})]),_:1}),e(M,{class:"d-flex justify-end"},{default:t(()=>[e(C,{color:"primary",variant:"tonal",icon:"mdi-pencil",onClick:d})]),_:1})]),_:1})):P("",!0)}}),Y=A(X,[["__scopeId","data-v-791fc0da"]]),Z=S({__name:"DeleteProfile",props:{profileUuid:{}},emits:["profileDeleted"],setup(D,{emit:b}){const o=r(!1),d=r(""),p=r(""),l=D,w=b,V=r(!1),m=r(!1);T();const E=async()=>{m.value=!0;try{const v=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/${l.profileUuid}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!v.ok)throw new Error(`Erreur ${v.status}: Suppression échouée`);V.value=!1,w("profileDeleted",{message:"Profil supprimé avec succès",color:"green"})}catch(v){console.error(v);const s=v instanceof Error?v.message:"Erreur inattendue";w("profileDeleted",{message:s,color:"red"})}finally{m.value=!1}};return(v,s)=>(c(),x("div",null,[e(C,{color:"error",icon:"mdi-delete",density:"comfortable",onClick:s[0]||(s[0]=y=>V.value=!0)}),e(G,{modelValue:V.value,"onUpdate:modelValue":s[2]||(s[2]=y=>V.value=y),"max-width":"500"},{default:t(()=>[e(B,null,{default:t(()=>[e(j,{class:"headline"},{default:t(()=>s[4]||(s[4]=[a("Confirmer la suppression")])),_:1}),e(z,null,{default:t(()=>s[5]||(s[5]=[a(" Êtes-vous sûr de vouloir supprimer ce profil ? ")])),_:1}),e(M,null,{default:t(()=>[e(H),e(C,{color:"grey",onClick:s[1]||(s[1]=y=>V.value=!1)},{default:t(()=>s[6]||(s[6]=[a("Annuler")])),_:1}),e(C,{color:"red",loading:m.value,onClick:E},{default:t(()=>s[7]||(s[7]=[a("Supprimer")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,{modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=y=>o.value=y),color:p.value,timeout:"3000"},{default:t(()=>[a(u(d.value),1)]),_:1},8,["modelValue","color"])]))}}),ee=["href"],te={key:1},le=S({__name:"TableProfile",setup(D){const b=T(),o=r([]),d=r(null),p=r(""),l=r(!1),w=r(""),V=r("");r(null);const m=r(null);$(()=>{const i=sessionStorage.getItem("selectedConsultant");i?(m.value=JSON.parse(i),y()):d.value="Aucun consultant sélectionné."});const E=()=>{m.value?(sessionStorage.setItem("selectedConsultantUuid",m.value.consultantUuid),b.push("/profile/add-profile")):d.value="Aucun consultant sélectionné."},v=i=>{w.value=i.message,V.value=i.color,l.value=!0,y()},s=r([{key:"jobTitle",title:"Titre du poste",align:"start"},{key:"experienceLevel",title:"Expérience",align:"start"},{key:"rateHour",title:"Tarif / heure",align:"end"},{key:"cv",title:"Lien CV",align:"center"},{key:"cvDate",title:"Date CV",align:"end"},{key:"skills",title:"Compétences",align:"start"},{key:"keywords",title:"Mots-clés",align:"start"},{key:"actions",title:"Modifier",align:"center"},{key:"actionsSupp",title:"Supprimer",align:"center"}]),y=async()=>{if(!m.value){d.value="Aucun consultant trouvé.";return}try{const i=await fetch(`https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/profil/consultant/${m.value.consultantUuid}`);if(!i.ok)throw new Error("Erreur lors de la récupération des profils");const f=await i.json();o.value=f}catch(i){d.value=i instanceof Error?i.message:"Une erreur est survenue"}},J=i=>{localStorage.setItem("selectedProfile",JSON.stringify(i)),b.push({path:"/profile/edit-profile"})};return(i,f)=>(c(),x(N,null,[e(R,null,{default:t(()=>[f[3]||(f[3]=k("h1",{class:"text-center mb-6"},"Liste des Profils",-1)),e(C,{onClick:E,icon:"mdi-plus",color:"primary",class:"mb-4"}),d.value?(c(),I(U,{key:0,type:"error",variant:"outlined",class:"mb-4"},{default:t(()=>[a(u(d.value),1)]),_:1})):P("",!0),e(K,{modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=n=>p.value=n),label:"Rechercher un profil","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"mb-4"},null,8,["modelValue"]),e(Q,{headers:s.value,items:o.value,search:p.value,"item-value":"consultantUuid",class:"elevation-2"},{"item.cv":t(({item:n})=>[n.cv&&n.cv.trim()!==""?(c(),x("a",{key:0,href:n.cv,target:"_blank"},"Voir le CV",8,ee)):(c(),x("span",te,"Non disponible"))]),"item.skills":t(({item:n})=>{var _;return[a(u((_=n.skills)!=null&&_.length?n.skills.join(", "):"Aucune compétence"),1)]}),"item.keywords":t(({item:n})=>{var _;return[a(u((_=n.keywords)!=null&&_.length?n.keywords.join(", "):"Aucun mot-clé"),1)]}),"item.actions":t(({item:n})=>[e(C,{color:"primary",onClick:_=>J(n),icon:"mdi-pencil",density:"comfortable"},null,8,["onClick"])]),"item.actionsSupp":t(({item:n})=>[e(Z,{profileUuid:n.profileUuid,onProfileDeleted:v},null,8,["profileUuid"])]),_:1},8,["headers","items","search"]),!o.value.length&&!d.value?(c(),I(U,{key:1,type:"info",class:"mt-4"},{default:t(()=>f[2]||(f[2]=[a(" Aucun profil disponible. ")])),_:1})):P("",!0)]),_:1}),e(O,{modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=n=>l.value=n),color:V.value,timeout:"3000"},{default:t(()=>[a(u(w.value),1)]),_:1},8,["modelValue","color"])],64))}}),oe=A(le,[["__scopeId","data-v-617dfef5"]]),me=S({__name:"consultant-info",setup(D){return(b,o)=>(c(),x(N,null,[e(Y),e(oe)],64))}});export{me as default};
