import{_ as b,V as j}from"./VForm-BD57haRY.js";import{h as P,j as p,a5 as B,O as V,k as N,_ as T,o as C,i as y,w as o,f as l,n as v,a6 as z,a7 as A,V as D}from"./index-CXmdwxo-.js";import{V as S,a as F,b as L,c as O}from"./VCard-DpfQPIBz.js";import{V as G,a as n}from"./VRow-D9b1hgQV.js";import{V as s}from"./VTextField-DQoh-tBi.js";import{V as J}from"./VSwitch-Cb4-sE-K.js";import{V as M}from"./VSelect-BgZoX6lA.js";import{V as H}from"./forwardRefs-BGojW5Df.js";const K=P({name:"AddConsultant",components:{GoBackBtn:b},setup(){const e=p({Email:"",AvailabilityDate:"",ExpirationDateCI:"",Intern:!1,Name:"",Surname:"",enterprise:"",Phone:"",CopyCI:"",Picture:""}),a=B(),d=p([]),m=p(null),u="https://static.vecteezy.com/system/resources/thumbnails/003/337/584/small/default-avatar-photo-placeholder-profile-icon-vector.jpg",i=p(u),c=t=>(t==null?void 0:t.trim())!==""||"Champ obligatoire",r=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||"Format invalide (ex: exemple@mail.com)",h=t=>/^\+?[0-9]{9,15}$/.test(t)||"Format invalide (ex: +32444332211)",g=t=>/^(https?:\/\/)[^\s$.?#].[^\s]*$/.test(t)||"Lien invalide (ex: https://...)",E=t=>/^(https?:\/\/.*\.(?:png|jpg|jpeg|gif|webp))$/i.test(t)||"Lien image invalide (ex: https://site.com/photo.jpg)",w=t=>!!t||"Veuillez choisir une date",I=async()=>{try{const t=await fetch("https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/enterprise");if(!t.ok)throw new Error("Erreur lors du chargement des entreprises");const f=await t.json();d.value=f}catch(t){console.error("Erreur fetch entreprises :",t)}};V(()=>e.value.Intern,t=>{t?e.value.enterprise="O2do":e.value.enterprise=""});const q=()=>{if(!e.value.Picture||e.value.Picture.trim()===""){i.value=u;return}const t=new Image;t.src=e.value.Picture,t.onload=()=>{i.value=e.value.Picture},t.onerror=()=>{i.value=u}},R=()=>{e.value.Picture===u&&(e.value.Picture="")},U=()=>{e.value.Picture||(e.value.Picture=u)},$=()=>{i.value=u};V(()=>e.value.Picture,q);const k=async()=>{try{if((!e.value.Picture||e.value.Picture.trim()==="")&&(e.value.Picture=u),!m.value)return;const{valid:t}=await m.value.validate();if(!t)return;if(!(await fetch("https://autodo-fpe3azgvbvcxbgcx.westeurope-01.azurewebsites.net/consultant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.value)})).ok)throw new Error("Erreur lors de l'ajout du consultant");setTimeout(()=>{a.push("/consultant/list-consultant")},1e3)}catch(t){console.error(t instanceof Error?t.message:"Une erreur est survenue")}};return N(()=>{I()}),{consultant:e,enterprises:d,formRef:m,validPicture:i,required:c,emailRule:r,phoneRule:h,urlRule:g,imageUrlRule:E,dateRule:w,clearPlaceholder:R,restorePlaceholder:U,setPlaceholder:$,submitConsultant:k,placeholderImage:u}}});function Q(e,a,d,m,u,i){const c=b;return C(),y(D,null,{default:o(()=>[l(S,{class:"pa-4"},{default:o(()=>[l(c,{class:"mb-4"}),l(F,{class:"text-h5 font-weight-bold"},{default:o(()=>a[10]||(a[10]=[v("Nouveau Consultant")])),_:1}),l(L,null,{default:o(()=>[l(j,{ref:"formRef"},{default:o(()=>[l(G,null,{default:o(()=>[l(n,{cols:"12",class:"d-flex flex-column align-center"},{default:o(()=>[l(z,{size:"150"},{default:o(()=>[l(A,{src:e.validPicture,alt:"Photo Consultant",contain:"",onError:e.setPlaceholder},null,8,["src","onError"])]),_:1})]),_:1}),l(n,{cols:"12"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Lien Photo *",modelValue:e.consultant.Picture,"onUpdate:modelValue":a[0]||(a[0]=r=>e.consultant.Picture=r),placeholder:e.placeholderImage,rules:[e.required,e.imageUrlRule],onFocus:e.clearPlaceholder,onBlur:e.restorePlaceholder},null,8,["modelValue","placeholder","rules","onFocus","onBlur"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Prénom *",modelValue:e.consultant.Surname,"onUpdate:modelValue":a[1]||(a[1]=r=>e.consultant.Surname=r),rules:[e.required],required:""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Nom *",modelValue:e.consultant.Name,"onUpdate:modelValue":a[2]||(a[2]=r=>e.consultant.Name=r),rules:[e.required],required:""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Lien Copie CI *",modelValue:e.consultant.CopyCI,"onUpdate:modelValue":a[3]||(a[3]=r=>e.consultant.CopyCI=r),rules:[e.required,e.urlRule],required:""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Expiration CI *",modelValue:e.consultant.ExpirationDateCI,"onUpdate:modelValue":a[4]||(a[4]=r=>e.consultant.ExpirationDateCI=r),type:"date",rules:[e.required,e.dateRule]},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(J,{variant:"outlined",color:"primary",label:"Interne",modelValue:e.consultant.Intern,"onUpdate:modelValue":a[5]||(a[5]=r=>e.consultant.Intern=r)},null,8,["modelValue"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(M,{label:"Entreprise *",modelValue:e.consultant.enterprise,"onUpdate:modelValue":a[6]||(a[6]=r=>e.consultant.enterprise=r),items:e.enterprises,"item-title":"name","item-value":"name",rules:[e.required],variant:"outlined",color:"primary",disabled:!!e.consultant.Intern},null,8,["modelValue","items","rules","disabled"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Email *",modelValue:e.consultant.Email,"onUpdate:modelValue":a[7]||(a[7]=r=>e.consultant.Email=r),rules:[e.required,e.emailRule],required:""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Téléphone *",modelValue:e.consultant.Phone,"onUpdate:modelValue":a[8]||(a[8]=r=>e.consultant.Phone=r),rules:[e.required,e.phoneRule],required:""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"6"},{default:o(()=>[l(s,{variant:"outlined",color:"primary",label:"Date de disponibilité *",modelValue:e.consultant.AvailabilityDate,"onUpdate:modelValue":a[9]||(a[9]=r=>e.consultant.AvailabilityDate=r),type:"date",rules:[e.dateRule],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(O,{class:"d-flex justify-end"},{default:o(()=>[l(H,{color:"primary",onClick:e.submitConsultant},{default:o(()=>a[11]||(a[11]=[v("Publier")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}const W=T(K,[["render",Q]]),ae=P({__name:"add-consultant",setup(e){return(a,d)=>(C(),y(W))}});export{ae as default};
